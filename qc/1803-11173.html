<!-- Layout is not a branch of default! -->


<!DOCTYPE html>
<html lang="en" ><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Removed favicon
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff"> --><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>1803.11173 Notes | Warren Alphonso</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="1803.11173 Notes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Barren plateaus in quantum neural network training landscapes" />
<meta property="og:description" content="Barren plateaus in quantum neural network training landscapes" />
<meta property="og:site_name" content="Warren Alphonso" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-04T01:57:29+00:00" />
<script type="application/ld+json">
{"description":"Barren plateaus in quantum neural network training landscapes","@type":"BlogPosting","url":"/qc/1803-11173","headline":"1803.11173 Notes","dateModified":"2020-04-20T05:37:32+00:00","datePublished":"2020-12-04T01:57:29+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/qc/1803-11173"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Warren Alphonso" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-147966026-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<!-- Refreshes whenever I save 
  <script type="text/javascript" src="http://livejs.com/live.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/showdown/<version tag>/showdown.min.js"></script>
  -->

  <!-- MathJax. We use `defer` to make sure everything loads before running MathJax config. -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <script src="/mathjax-config.js" defer></script>
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- Displays site.title on header but I think it looks ugly -->
    <!-- <a class="site-title" rel="author" href="/">Warren Alphonso</a> --><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <article class="writing">
          <div class="writing-map">
            <!-- <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#barren-plateaus-in-quantum-neural-network-training-landscapes">Barren plateaus in quantum neural network training landscapes</a>
<ul>
<li class="toc-entry toc-h2"><a href="#gradient-concentration-in-random-circuits">Gradient concentration in random circuits</a>
<ul>
<li class="toc-entry toc-h3"><a href="#gradient">Gradient</a></li>
<li class="toc-entry toc-h3"><a href="#appendix-proof">Appendix Proof</a></li>
<li class="toc-entry toc-h3"><a href="#graphs">Graphs</a></li>
<li class="toc-entry toc-h3"><a href="#done-with-calculation-of-gradient">Done with Calculation of Gradient</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#numerical-simulation">Numerical Simulation</a></li>
</ul>
</li>
</ul> only works for posts collection and  works for everything else. -->
            <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#barren-plateaus-in-quantum-neural-network-training-landscapes">Barren plateaus in quantum neural network training landscapes</a>
<ul>
<li class="toc-entry toc-h2"><a href="#gradient-concentration-in-random-circuits">Gradient concentration in random circuits</a>
<ul>
<li class="toc-entry toc-h3"><a href="#gradient">Gradient</a></li>
<li class="toc-entry toc-h3"><a href="#appendix-proof">Appendix Proof</a></li>
<li class="toc-entry toc-h3"><a href="#graphs">Graphs</a></li>
<li class="toc-entry toc-h3"><a href="#done-with-calculation-of-gradient">Done with Calculation of Gradient</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#numerical-simulation">Numerical Simulation</a></li>
</ul>
</li>
</ul> 
            
          </div>  
          <div class="writing-content">
            <p class="post-meta">
                <time class="dt-published" datetime="2020-12-04T01:57:29+00:00" itemprop="datePublished"><!-- Dec 4, 2020 -->
                  <!-- Only works with posts and breaks for drafts I think. It's showing Oct 26, 2019 for drafts. -->
                  Last updated: Apr 20, 2020
                </time></p>
            <h1 id="barren-plateaus-in-quantum-neural-network-training-landscapes">Barren plateaus in quantum neural network training landscapes</h1>
<p>I <strong>need</strong> to read the <a href="https://arxiv.org/pdf/1509.04279.pdf">original VQE paper</a>.</p>
<p>Variational algorithms are resistant to noise. I don’t really understand this part; the paper to really understand in order to get a feel for this topic is <a href="/qc/1603-05681">1603.05681</a>.</p>
<p>Variational methods usually rely on “optimizing a unitary circuit with respect to an objective function that is a sum of Pauli operators or fidelity”. I think this means an objective function that is based on measurement values of sums of Pauli operators.</p>
<p>Papers about informed ansatze: - <a href="https://arxiv.org/pdf/1605.05370.pdf">Training a Quantum Optimizer</a> - <a href="https://dash.harvard.edu/bitstream/handle/1/27692608/Exploiting%20Locality%20in%20Quantum.pdf?sequence=1">Exploiting Locality in Quantum Computation for Quantum Chemsitry</a> - <a href="https://arxiv.org/abs/1701.02691">Strategies for quantum computing molecular energies using the unitary coupled cluster ansatz</a> - <a href="https://www.researchgate.net/publication/323927159_Low-Depth_Quantum_Simulation_of_Materials">Low-Depth Quantum Simulation of Materials</a> - <a href="https://arxiv.org/abs/1801.03524">Application of fermionic marginal constraints to hybrid quantum algorithms</a> - <a href="https://arxiv.org/abs/1711.04789">Quantum Simulation of Electronic Structure with Linear Depth and Connectivity</a></p>
<p>Another common method is to use random circuits of varying depth as ansatz.</p>
<p>In the quantum case, the estimation of even a single gradient component scales as <span class="math inline">\(O(1 / \epsilon^\alpha )\)</span> for some small <span class="math inline">\(\alpha\)</span>, see <a href="https://arxiv.org/abs/quant-ph/0607019">Optimal Quantum Measurements of Expectation Values of Observables</a> , whereas classically the same is achieved in <span class="math inline">\(O(\log (1/\epsilon))\)</span> time.</p>
<p>There’s a figure that talks about concentration of measure in quantum space (the faction of states that fall outside a fixed angular distance from 0 along any coordinate) decreases exponentially in the number of qubits. SOURCE is <em>The Concentration of Measure Phenomenon</em> by Michel Ledoux page 89.</p>
<p>The paper shows that for many random circuits, the average value of the gradient of the objective function is 0, and probability of deviating from this is exponentially small in number of qubits.</p>
<p>This can be understood in the geometric context of concentration of measure for high dimensional spaces: - <a href="https://people.physics.anu.edu.au/~tas110/Teaching/Lectures/L5/Material/Popescu06.pdf">Entanglement and the foundation of statistical mechanics</a> - <a href="https://arxiv.org/abs/0812.3001v1">Are random pure states useful for quantum computation?</a> - <a href="https://duckduckgo.com/?q=%E2%80%9CMost+quantum+states+are+too+entangled+to+be+useful+as+computational+resources%2C%E2%80%9D&amp;t=brave&amp;ia=web">Most quantum states are too entangled to be useful as computational resources</a></p>
<p>When the measure of the space concentrates in this way, the value of any reasonably smooth function will tend to its average with exponential probability, by Levy’s lemma (same textbook source). This means the gradient is zero over vast reaches of quantum space.</p>
<p>The regions where the gradient is 0 aren’t local minima but are states with exponentially small deviations in the objective value from average totally mixed state.</p>
<p>The depth of circuits which achieve these undesirable properties are modest; we only need <span class="math inline">\(O(n^{1/d})\)</span> depth circuits on a <span class="math inline">\(d\)</span> dimensional array.</p>
<h2 id="gradient-concentration-in-random-circuits">Gradient concentration in random circuits</h2>
<p>A random parameterized quantum circuit: \[ U() = U(_1, , _L ) = _{l=1}^L U_l (_l) W_l \]</p>
<p>where <span class="math inline">\(U\_l (\theta\_l) = \exp (-i \theta\_l V\_l)\)</span>; <span class="math inline">\(V\_l\)</span> is Hermitian; and <span class="math inline">\(W\_l\)</span> is a generic unitary that doesn’t depend on angle <span class="math inline">\(\theta\_l\)</span>.</p>
<p>We choose this form so we can evaluate the gradient easily for most objective functions. This form has also been introduced in: - <a href="https://arxiv.org/abs/1701.02691">Strategies for quantum computing molecular energies using the unitary coupled cluster ansatz</a> - <a href="https://arxiv.org/abs/1701.01450">Practical optimization for hybrid quantum-classical algorithms</a></p>
<p>If we have an objective function <span class="math inline">\(E(\theta)\)</span> expressible as the expectation of some Hermitian <span class="math inline">\(H\)</span>, \[ E(  ) =  U()^{} HU()  \]</p>
<p>(Okay the above makes sense.) When the RPQCs are parameterized like this, the gradient is: \[ _k E  = i  U^{}_{-} U_-  \] where we introduce \[ U_- _{l=0}^{k-1} U_l (_l ) W_l \] and \[ U_+ _{l=k}^L U_l (_l) W_l \]</p>
<p>We also define the RPQC <span class="math inline">\(U ( \overrightarrow{\theta} )\)</span> such that for any gradient direction <span class="math inline">\(\partial\_k E\)</span>, the circuit implementing <span class="math inline">\(U( \overrightarrow{\theta} )\)</span> is sufficiently random such that either <span class="math inline">\(U\_-\)</span>, <span class="math inline">\(U\_+\)</span>, or both match the Haar distribution up to the second moment, and the circuits <span class="math inline">\(U\_-\)</span> and <span class="math inline">\(U\_+\)</span> are independent.</p>
<p>We use the Haar measure on the unitary group <span class="math inline">\(d \mu(U)\)</span>, which is the unique left- and right-invariant measure such that \[ _{U(N)} d(U) f(U) = d(U) f(VU) = d(U) f(UV) \] for any <span class="math inline">\(f(U)\)</span> and <span class="math inline">\(V \in U(N)\)</span>.</p>
<p>This is useful for proofs, but quantum circuits which exactly achieve this require exponential resources, so we introduce unitary <span class="math inline">\(t\)</span>-designs, which satisfy the above properties for restricted classes of <span class="math inline">\(f(U)\)</span>, usually requiring only polynomial resources. - <a href="https://arxiv.org/abs/quant-ph/0310075">Symmetric Informationally Complete Quantum Measurements</a> - <a href="https://cs.uwaterloo.ca/~cleve/pubs/2009TwoDesigns.pdf">Exact and approximate unitary 2-designs and their applications to fidelity estimation</a> - <a href="https://arxiv.org/abs/0802.1919">Random Quantum Circuits are Approximate 2-designs</a></p>
<p>Suppose <span class="math inline">\(\{ p\_i, V\_i \}\)</span> is an ensemble of unitary operators sampled with some probability. This ensemble is a <span class="math inline">\(t\)</span>-design if \[ _i p_i V_i^{t} (V_i<sup>)</sup>{t} = d (U) U^{t} (U<sup>)</sup>{t} \]</p>
<p>This is equivalent to the property that if <span class="math inline">\(f(U)\)</span> is a polynomial of at most degree <span class="math inline">\(t\)</span> in the matrix elements of <span class="math inline">\(U^*\)</span>, then averaging over the <span class="math inline">\(t\)</span>-design will yield the same result as averaging over the unitary group with respect to the Haar measure.</p>
<h3 id="gradient">Gradient</h3>
<p>The average value of the gradient is a concept that requires additional specification because, for a given point, the gradient can only be defined in terms of the circuit that led to that point.</p>
<p>We will use a practical definition that gives the value we’re interested in, namely: \[ _k E = dUp(U) _k  U ()^HU()  \] where <span class="math inline">\(p(U)\)</span> is probability distribution function (?) of <span class="math inline">\(U\)</span>.</p>
<p>A review I’ll need to read: <a href="https://arxiv.org/abs/1510.06128">Products of Independent Gaussian Random Matrices</a>.</p>
<p>Our assumption of independence and at least one of <span class="math inline">\(U\_-, U\_+\)</span> forming a 1-design in our RPQCs implies <span class="math inline">\(\langle \partial\_k E \rangle = 0\)</span>.</p>
<h3 id="appendix-proof">Appendix Proof</h3>
<p>Here we show expectation of gradient is 0 and that variance decays exponentially in number of qubits.</p>
<p>The main source for the following computations is <a href="https://arxiv.org/abs/1109.4244">Symbolic integration with respect to the Haar measure on the unitary group</a>.</p>
<p>We know that for any direction <span class="math inline">\(\partial\_k E\)</span>, both <span class="math inline">\(U\_-, U\_+\)</span> are independently distributed and either <span class="math inline">\(U\_-\)</span> or <span class="math inline">\(U\_+\)</span> match the Haar distribution up to at least the second moment (since they are a 2-design).</p>
<p>The assumption of independence is equivalent to: \[ p(U) = dU_+ p(U_+) dU_- p(U_-) (U_+ U_- - U) \] which lets us rewrite (?) as \[ _k E = i dU_- p(U_-)  \{ _- dU_+ p(U_+) \} \]</p>
<p>Using explicit integration over the unitary group from the source above with respect to the Haar measure, up to the first moment is</p>
<p>\[ d(U) U_{ij} U_{km}^= d(U) U_{ij} U_{mk}^* =  \] where <span class="math inline">\(N\)</span> is dimension, usually <span class="math inline">\(2^n\)</span> for <span class="math inline">\(n\)</span> qubits. This means that \[ M = d(U) UOU^=  I \]</p>
<p>Now, using our assumption that <span class="math inline">\(U\_+\)</span> or <span class="math inline">\(U\_-\)</span> matches the Haar measure up to the first moment (they’re 1-design), we first examine the case wehre <span class="math inline">\(U\_-\)</span> is at least a 1-design: \[ _k E = i d(U_-)  \{ _- \} =   = 0 \]</p>
<p>where we define <span class="math inline">\(\rho\_- = U\_- \ket{0} \bra{0} U\_{-}^\dagger\)</span>. We used the fact that trace of a commutator of trace class operators is 0.</p>
<p>The second case is when <span class="math inline">\(U\_+\)</span> is at least a 1-design: \[ _k E = i dU_- p(U_-)  \{ _- d(U_+) \} = i  dU_- p(U_-)  \{ _- \} = 0 \]</p>
<p>An advantage of the explicit polynomial formulas is that they allow an analytic calculation of the variance which allows precise specification of the coefficient in Levy’s lemma. If the integrals depend on up to two powers of elements in <span class="math inline">\(U\)</span> and <span class="math inline">\(U^\*\)</span>, we can use the elementwise formula from source: \[ d(U) U OH LORD THERE"S A LOT \]</p>
<p>Since we know <span class="math inline">\(\langle \partial\_k E \rangle = 0\)</span>, the variance is defined by <span class="math inline">\(\mathrm{Var} ( \partial\_k E) = \langle ( \partial\_k E )^2 \rangle\)</span>.</p>
<p>Using the above elementwise formula for integrating up to second moment of the Haar distribution, we evaluate in 3 cases.</p>
<p>Case 1: <span class="math inline">\(U\_-\)</span> is a 2-design but not <span class="math inline">\(U\_+\)</span>:</p>
<p>\[ (_k E) =   H_{u}^2 V^2 - (H_u V)^2 _{U_+} = -   ^2 _{U_-} \] where <span class="math inline">\(H\_u = u^\dagger H u\)</span> and <span class="math inline">\(\langle f(u) \rangle\_{U\_x}\)</span> means the average over <span class="math inline">\(u\)</span> sampled from <span class="math inline">\(p(U\_x)\)</span>.</p>
<p>Case 2: <span class="math inline">\(U\_+\)</span> is a 2-design but not <span class="math inline">\(U\_-\)</span>:</p>
<p>\[  (_k E) =   _{u}^2 V^2 - (_u V)^2 _{U_-} = -   ^2_{U_-} \]</p>
<p>where <span class="math inline">\(\rho\_u = u \rho u^\dagger\)</span>.</p>
<p>Case 3: Both <span class="math inline">\(U\_+, U\_-\)</span> are 2-designs:</p>
<p>\[  (_k E) = 2  (H^2)  (^2) (  -  ) \]</p>
<p>In all cases, exponential decay with respect to qubits is clear.</p>
<h3 id="graphs">Graphs</h3>
<p>Sample variance of gradient of <span class="math inline">\(H = \ket{00...0} \bra{00...0}\)</span> exponentially decays as a function of number of qubits.</p>
<p>Sample variance of gradient of <span class="math inline">\(H = \ket{00...0} \bra{00...0}\)</span> converges to a fixed value determined by number of qubits.</p>
<h3 id="done-with-calculation-of-gradient">Done with Calculation of Gradient</h3>
<p>Levy’s lemme intuits expected variance through geometric arguments. Haar random unitaries on <span class="math inline">\(n\)</span> qubits will output states uniformly in <span class="math inline">\(2^n -1\)</span> dimensional hyperspace. The derivative wrt parameters <span class="math inline">\(\theta\)</span> is Lipschitz continuous with some parameter <span class="math inline">\(\eta\)</span> that depends on operator <span class="math inline">\(H\)</span>. Levy’s lemma implies variance of measurements will decrease exponentially in number of qubits.</p>
<p>This variance depends on polynomials of degree 2 in <span class="math inline">\(U\)</span> and polynomials of degree 2 of <span class="math inline">\(U^\*\)</span>.</p>
<p>While a unitary 2-design will exhibit correct variance, a unitary 1-design will exhibit correct average variance but not necessarily variance. - “Exact and approximate unitary 2-designs and their application to fidelity estimation” paper. - <a href="https://arxiv.org/abs/1610.04903">Chaos and complexity by design</a></p>
<p>So, if a circuit is of sufficient depth that for any <span class="math inline">\(\partial\_k E\)</span>, either $U_-, U_+, $ or both form 2-designs, then with high probability we’ll produce an ansatz on a barren plateau with no interesting search directions in sight.</p>
<h2 id="numerical-simulation">Numerical Simulation</h2>

          </div>
        </article>
    </main>

    <!-- To render the footer properly with new page width -->
    <footer class="site-footer h-card">
        <data class="u-url" href="/"></data>
        <div class="writing">
          <div class="footer-col-wrapper">
            <div class="footer-col footer-col-2">
              <p>Built with Jekyll. Hosted on Github Pages. </p>
            </div>
          </div>
        </div>
      </footer>
      
  </body>

</html>
